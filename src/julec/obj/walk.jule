// Copyright 2024 The Jule Programming Language.
// Use of this source code is governed by a BSD 3-Clause
// license that can be found in the LICENSE file.

use sema for std::jule::sema

fn IterPackages(mut &ir: &IR, f: fn(mut &pkg: &sema::Package)) {
	for (_, mut used) in ir.Used {
		if !used.Binded {
			f(used.Package)
		}
	}
	f(ir.Main)
}

fn IterFiles(mut &pkg: &sema::Package, f: fn(mut &f: &sema::SymTab)) {
	for (_, mut file) in pkg.Files {
		f(file)
	}
}

fn iterTraitInheritMethods(mut &base: &sema::Trait, mut &t: &sema::Trait, f: fn(mut &m: &sema::Fn)) {
	iterTraitInheritMethods1(base, t, f)
	for (_, mut m) in t.Methods {
		if !ContainsTraitMethod(base, m.Ident) { // Do not iterate iterated method.
			f(m)
		}
	}
}

fn iterTraitInheritMethods1(mut &base: &sema::Trait, mut &t: &sema::Trait, f: fn(mut &m: &sema::Fn)) {
	for (_, mut inh) in t.Inherits {
		mut t2 := inh.Kind.Trait()
		iterTraitInheritMethods(base, t2, f)
	}
}

// Iterates methods of trait, including inherited methods.
fn IterTraitMethods(mut &t: &sema::Trait, f: fn(mut &m: &sema::Fn)) {
	for (_, mut m) in t.Methods {
		f(m)
	}
	iterTraitInheritMethods1(t, t, f)
}